<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.8">
<meta name="keywords" content="Retail Banking Widget Collection, BACKBASE, services">
<title>Implement an OAuth 2.0-compatible Auth Client</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="./asciidoctor.css">
<style>.toc-current{font-weight: bold;} .toc-root{font-family: "Open Sans","DejaVu Sans",sans-serif;
                         font-size: 0.9em;} #content{display: flex; flex-direction: column; flex: 1 1 auto;}
               .nav-footer{text-align: center; margin-top: auto;}
               .nav-footer > p > a {white-space: nowrap;}</style>
</head>
<body id="implementing_an_oauth_20_compatible_auth_client" class="book toc2 toc-left">
<div id="header">
<h1>Implement an OAuth 2.0-compatible Auth Client</h1>
<div class="details">
<span id="revnumber">version 3.10.1</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<p><span class="toc-root toc-current"><a href="index.html">Retail Banking Widget Collection</a></span></p><ul class="sectlevel1">
<li><a href="understand.html">Understand Retail Banking Widget Collection v3.10.1</a>
<ul class="sectlevel2">
<li><a href="what_are_widget_collections.html">What is Retail Banking Widget Collection</a>
</li>
<li><a href="entitlements_understand.html">Understand Access Control</a>
</li>
<li><a href="actions_understand.html">Understand Actions</a>
</li>
<li><a href="accountstatements_understand.html">Understand Account Statements</a>
<ul class="sectlevel3">
<li><a href="web_account_statements.html">Web widgets</a>
</li>
</ul>
</li>
<li><a href="authentication_understand.html">Understand Authentication</a>
<ul class="sectlevel3">
<li><a href="web_authentication.html">Web widgets</a>
</li>
</ul>
</li>
<li><a href="authorized_users_understand.html">Understand Authorized Users</a>
<ul class="sectlevel3">
<li><a href="web_authorized_users.html">Web widgets</a>
</li>
</ul>
</li>
<li><a href="billpay_understand.html">Understand Bill Pay</a>
<ul class="sectlevel3">
<li><a href="web_billpay.html">Web widgets</a>
</li>
<li><a href="native_bill_pay.html">Native mobile widgets</a>
</li>
</ul>
</li>
<li><a href="cardmanagement_understand.html">Understand Card Management</a>
<ul class="sectlevel3">
<li><a href="web_card_management.html">Web widgets</a>
</li>
<li><a href="native_card_management.html">Native mobile widgets</a>
</li>
</ul>
</li>
<li><a href="consents_understand.html">Understand Consents</a>
<ul class="sectlevel3">
<li><a href="web_consents.html">Web widgets</a>
</li>
</ul>
</li>
<li><a href="contacts_understand.html">Understand Contacts</a>
<ul class="sectlevel3">
<li><a href="web_contacts.html">Web widgets</a>
</li>
<li><a href="native_contacts.html">Native mobile widgets</a>
</li>
</ul>
</li>
<li><a href="messages_understand.html">Understand Messages</a>
<ul class="sectlevel3">
<li><a href="web_messages.html">Web widgets</a>
</li>
<li><a href="native_messages.html">Native mobile widgets</a>
</li>
</ul>
</li>
<li><a href="notifications_understand.html">Understand Notifications</a>
<ul class="sectlevel3">
<li><a href="web_notifications.html">Web widgets</a>
</li>
<li><a href="native_notifications.html">Native mobile widgets</a>
</li>
</ul>
</li>
<li><a href="payments_understand.html">Understand Payments</a>
<ul class="sectlevel3">
<li><a href="web_payments.html">Web widgets</a>
</li>
<li><a href="native_payments.html">Native mobile widgets</a>
</li>
</ul>
</li>
<li><a href="pfm_understand.html">Understand Personal Finance Management</a>
<ul class="sectlevel3">
<li><a href="web_pfm.html">Web widgets</a>
</li>
<li><a href="native_pfm.html">Native mobile widgets</a>
</li>
</ul>
</li>
<li><a href="places_understand.html">Understand Places</a>
<ul class="sectlevel3">
<li><a href="web_places.html">Web widgets</a>
</li>
<li><a href="native_places.html">Native mobile widgets</a>
</li>
</ul>
</li>
<li><a href="product_summary_understand.html">Understand Products</a>
<ul class="sectlevel3">
<li><a href="web_products.html">Web widgets</a>
</li>
<li><a href="native_products.html">Native mobile widgets</a>
</li>
</ul>
</li>
<li><a href="rdc_understand.html">Understand Remote Deposit Capture</a>
<ul class="sectlevel3">
<li><a href="native_rdc.html">Native mobile widgets</a>
</li>
</ul>
</li>
<li><a href="self_enrollment_understand.html">Understand Self Enrollment</a>
<ul class="sectlevel3">
<li><a href="web_self_enrollment.html">Web widgets</a>
</li>
</ul>
</li>
<li><a href="transaction_list_understand.html">Understand Transactions</a>
<ul class="sectlevel3">
<li><a href="web_transactions.html">Web widgets</a>
</li>
<li><a href="native_transactions.html">Native mobile widgets</a>
</li>
</ul>
</li>
<li><a href="user_self_service.html">Understand User Self Service</a>
<ul class="sectlevel3">
<li><a href="web_user_self_service.html">Web widgets</a>
</li>
</ul>
</li>
<li><a href="user_profile_understand.html">Understand User Profile</a>
<ul class="sectlevel3">
<li><a href="web_user_profile.html">Web widgets</a>
</li>
<li><a href="native_user_profile.html">Native mobile widgets</a>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="install_and_configure.html">Install</a>
<ul class="sectlevel2">
<li><a href="install_the_lean_page_template.html">Install the lean page template for Widget Collection 3</a>
</li>
<li><a href="setup_widget_development_environment.html">Set up a widget development environment</a>
</li>
</ul>
</li>
<li><a href="use.html">Adopt</a>
<ul class="sectlevel2">
<li><a href="adopt_omni_payment_widget.html">Adopt the Initiate omni payment widget</a>
</li>
<li><a href="adopt_payment_wizard_widget.html">Adopt the Payment Wizard widget</a>
</li>
<li><a href="configure_navigation_notifications_widgets.html">Configure navigation for Notifications widgets</a>
</li>
<li><a href="how_to_use_theming.html">Use theming</a>
</li>
<li><a href="use_backbase_app.html">Use the Retail Banking Mobile App with Community</a>
</li>
<li><a href="refresh_widget_data_automatically.html">Refresh widget data in the same view automatically</a>
</li>
<li><a href="configure_account_numbers_displaying_in_products.html">Configure account numbers formatting for Products widgets</a>
</li>
<li><a href="synchronize_masking_behavior_in_products.html">Synchronize masking behavior with backed in Products widgets.</a>
</li>
</ul>
</li>
<li><a href="extend_and_build.html">Extend and build</a>
<ul class="sectlevel2">
<li><a href="extend_and_build_with_wc3.html">Extend and build with Widget Collection 3</a>
<ul class="sectlevel3">
<li><a href="configure_place_types.html">Customize the Find branches and ATMs widget</a>
</li>
<li><a href="field_mapping.html">Field mapping</a>
</li>
<li><a href="country_injection.html">Country injection</a>
</li>
<li><a href="configure_self_enrollment_route_guard.html">Customize Self Enrollment with a route guard</a>
</li>
<li><a href="configure_self_enrollment_identification_form.html">Customize the Self Enrollment with Identification form</a>
</li>
</ul>
</li>
<li><a href="extend_and_build_native.html">Extend and build native mobile apps</a>
<ul class="sectlevel3">
<li><a href="understanding_native_mobile_apps.html">Understand native mobile apps</a>
</li>
<li><a href="search_bar_framework.html">Understand the search bar framework</a>
</li>
<li><a href="integrating_a_mobile_widget_collection.html">Integrate a mobile widget collection</a>
</li>
<li><a href="implementing_an_oauth_20_compatible_auth_client.html"><span class="toc-current">Implement an OAuth 2.0-compatible Auth Client</span></a>
</li>
<li><a href="build_rest_request.html">Build a REST request (iOS only)</a>
</li>
<li><a href="integrating_mobile_widgets.html">Install native mobile widgets</a>
</li>
<li><a href="integrating_native_client.html">Install native mobile clients</a>
</li>
<li><a href="journeys_in_widget_architecture.html">Integrate journeys in a widget-based mobile app</a>
</li>
<li><a href="customize_payment_order_widget.html">Customize the Create payment order widget</a>
</li>
<li><a href="customize_products_converters.html">Customize Product Converters</a>
</li>
<li><a href="bill_pay_usage_guide.html">Integrate the Schedule bill pay widget along with the Create bill payment widget</a>
</li>
<li><a href="transactions_filter_usage_guide.html">Integrate the Filter transactions widget with the View transactions widget</a>
</li>
<li><a href="integrate_transaction_details_widget.html">Integrate the View transaction details widget in your experience</a>
</li>
<li><a href="integrate_transactions_filter_amount_range_widget.html">Integrate the Filter transactions by amount range widget with the Filter transactions widget</a>
</li>
<li><a href="integrate_transactions_filter_date_range_widget.html">Integrate the Filter transactions by date range widget with the View transactions widget</a>
</li>
<li><a href="integrate_transactions_filter_type_widget.html">Integrate the Filter transactions by transaction type widget with the Filter transactions widget</a>
</li>
<li><a href="integrate_view_check_images_widget.html">Integrate the View check images widget with the View transaction details widget</a>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="reference.html">Reference</a>
<ul class="sectlevel2">
<li><a href="web_reference.html">Web widgets</a>
<ul class="sectlevel3">
<li><a href="account_information_consent_reference.html">Account information consent</a>
</li>
<li><a href="account_information_dashboard_revoke_reference.html">Account information dashboard and revoke</a>
</li>
<li><a href="manage_retail_notification_preferences_reference.html">Manage retail notification preferences</a>
</li>
<li><a href="link_external_account_reference.html">Connect external account</a>
</li>
<li><a href="contact_manager_reference.html">Contact manager</a>
</li>
<li><a href="authorized_user_create_reference.html">Create authorized user</a>
</li>
<li><a href="self_enrollment_create_account_reference.html">Create online banking account</a>
</li>
<li><a href="create_message_reference.html">Compose message by the customer</a>
</li>
<li><a href="bill_pay_auto_enrolment_reference.html">Enroll bill pay automatically</a>
</li>
<li><a href="bill_pay_ebills_payveris_enrolment_reference.html">Enroll Payveris eBills</a>
</li>
<li><a href="places_reference.html">Find branches and ATMs</a>
</li>
<li><a href="bill_pay_enrolment_guard_reference.html">Guard bill pay enrollment</a>
</li>
<li><a href="omni_payment_reference.html">Initiate omni payment</a>
</li>
<li><a href="payment_wizard_reference.html">Initiate payment wizard</a>
</li>
<li><a href="list_account_information_consents_reference.html">List account information consents</a>
</li>
<li><a href="login_reference.html">Log in user</a>
</li>
<li><a href="notification_badge_reference.html">Notification badge</a>
</li>
<li><a href="bill_pay_manage_payee_reference.html">Manage bill payee</a>
</li>
<li><a href="bill_pay_manage_payments_reference.html">Manage bill payments</a>
</li>
<li><a href="budget_reference.html">Manage budgets</a>
</li>
<li><a href="card_management_details_reference.html">Manage cards</a>
</li>
<li><a href="product_summary_manage_accounts_reference.html">Manage retail account settings</a>
</li>
<li><a href="saving_goals_reference.html">Manage saving goals</a>
</li>
<li><a href="card_management_travel_notice_reference.html">Manage travel notice</a>
</li>
<li><a href="upcoming_payments_reference.html">Manage upcoming payments</a>
</li>
<li><a href="manage_user_security_reference.html">Manage user security</a>
</li>
<li><a href="user_manage_profile_reference.html">Manage user profile - non-admin</a>
</li>
<li><a href="payment_initiation_consent_reference.html">Payment initiation consent</a>
</li>
<li><a href="self_enrollment_identification_reference.html">Provide information for self-enrollment</a>
</li>
<li><a href="request_stop_checks_reference.html">Request stop checks</a>
</li>
<li><a href="product_summary_account_selector_reference.html">Select retail account</a>
</li>
<li><a href="self_enrollment_verification_reference.html">Verify identity for self-enrollment</a>
</li>
<li><a href="left_to_spend_reference.html">View amount left to spend</a>
</li>
<li><a href="authorized_user_view_reference.html">View authorized users</a>
</li>
<li><a href="account_statements_list_reference.html">View and download retail account statements</a>
</li>
<li><a href="bill_pay_payee_list_reference.html">View bill payees</a>
</li>
<li><a href="bill_pay_payee_summary_reference.html">View bill payee summary</a>
</li>
<li><a href="bill_pay_payments_reference.html">View bill payments</a>
</li>
<li><a href="card_management_overview_reference.html">View cards</a>
</li>
<li><a href="messages_conversation_thread_reference.html">View conversation thread by the customer</a>
</li>
<li><a href="messages_conversations_list_reference.html">View messages by the customer</a>
</li>
<li><a href="income_spending_analysis_reference.html">View income and spending by category</a>
</li>
<li><a href="self_enrollment_locked_out_reference.html">View locked out message for self-enrollment</a>
</li>
<li><a href="turnovers_reference.html">View monthly turnovers chart</a>
</li>
<li><a href="product_summary_view_details_reference.html">View retail account details</a>
</li>
<li><a href="product_summary_list_reference.html">View retail account list</a>
</li>
<li><a href="self_enrollment_confirmation_reference.html">View self-enrollment confirmation message</a>
</li>
<li><a href="view_sticky_popup_notifications_reference.html">View sticky and pop-up notifications</a>
</li>
<li><a href="stop_checks_list_reference.html">View stop check payment requests</a>
</li>
<li><a href="top_metrics_reference.html">View top spending metrics</a>
</li>
<li><a href="transactions_list_reference.html">View transactions list</a>
</li>
<li><a href="quick_transfer_reference.html">Quick transfer</a>
</li>
</ul>
</li>
<li><a href="native_reference.html">Native mobile widgets</a>
<ul class="sectlevel3">
<li><a href="bill_pay_native_reference.html">Manage bill payments</a>
</li>
<li><a href="bill_pay_form_native_reference.html">Create bill payment</a>
</li>
<li><a href="bill_pay_schedule_native_reference.html">Schedule bill payment</a>
</li>
<li><a href="budgets_native_reference.html">Manage budgets</a>
</li>
<li><a href="card_management_native_reference.html">Manage cards</a>
</li>
<li><a href="categories_native_reference.html">View income and spending by category</a>
</li>
<li><a href="contacts_native_reference.html">Manage contacts</a>
</li>
<li><a href="message_center_native_reference.html">Compose and receive messages</a>
</li>
<li><a href="notifications_native_reference.html">Manage notifications</a>
</li>
<li><a href="payment_order_native_reference.html">Create payment order</a>
</li>
<li><a href="schedule_payment_order_native_reference.html">Schedule payment order</a>
</li>
<li><a href="pin_request_native_reference.html">Request PIN</a>
</li>
<li><a href="pin_reset_native_reference.html">Reset PIN</a>
</li>
<li><a href="places_native_reference.html">Find branches and ATMs</a>
</li>
<li><a href="place_details_native_reference.html">View branch and ATM details</a>
</li>
<li><a href="product_details_native_reference.html">Manage account</a>
</li>
<li><a href="products_native_reference.html">Manage accounts</a>
</li>
<li><a href="rdc_form_native_reference.html">Submit remote deposit check</a>
</li>
<li><a href="rdc_history_native_reference.html">View remote deposit capture history</a>
</li>
<li><a href="saving_goals_native_reference.html">Manage saving goals</a>
</li>
<li><a href="selector_widget.html">Selector widget</a>
</li>
<li><a href="transactions_native_reference.html">View transactions, turnovers, and spending/income analysis</a>
</li>
<li><a href="transaction_details_native_reference.html">View transaction details</a>
</li>
<li><a href="transactions_check_images_native_reference.html">View check images</a>
</li>
<li><a href="transactions_filter_native_reference.html">Filter transactions</a>
</li>
<li><a href="transactions_filter_amount_range_native_reference.html">Filter transactions by amount range</a>
</li>
<li><a href="transactions_filter_date_range_native_reference.html">Filter transactions by date range</a>
</li>
<li><a href="transactions_filter_type_native_reference.html">Filter transactions by transaction type</a>
</li>
<li><a href="travel_notice_form_native_reference.html">Create travel notice</a>
</li>
<li><a href="travel_notice_list_native_reference.html">View travel notices</a>
</li>
<li><a href="user_profile_overview_native_reference.html">View user profile - non-admin</a>
</li>
</ul>
</li>
<li><a href="native_client_reference.html">Native mobile clients</a>
<ul class="sectlevel3">
<li><a href="access_control_client_reference.html">Access control</a>
</li>
<li><a href="actions_client_reference.html">Actions</a>
</li>
<li><a href="bill_pay_client_reference.html">Bill pay</a>
</li>
<li><a href="card_management_client_reference.html">Card management</a>
</li>
<li><a href="contacts_client_reference.html">Contacts</a>
</li>
<li><a href="notifications_client_reference.html">Notifications</a>
</li>
<li><a href="message_center_client_reference.html">Compose and receive messages</a>
</li>
<li><a href="payment_order_client_reference.html">Payment order</a>
</li>
<li><a href="places_client_reference.html">Places</a>
</li>
<li><a href="products_client_reference.html">Products</a>
</li>
<li><a href="pfm_client_reference.html">Personal finance management</a>
</li>
<li><a href="rdc_client_reference.html">Remote deposit capture</a>
</li>
<li><a href="transactions_client_reference.html">Transactions</a>
</li>
<li><a href="user_profile_client_reference.html">User profile</a>
</li>
</ul>
</li>
<li><a href="bb_product_compatibility.html">Backbase product compatibility</a>
</li>
<li><a href="retirement.html">Backbase software lifecycle</a>
</li>
<li><a href="common_utils.html">Common Utils</a>
</li>
<li><a href="experimental_features.html">Experimental features</a>
</li>
<li><a href="glossary.html">Glossary</a>
</li>
<li><a href="modendtbl.html">Module/Endpoint list</a>
</li>
<li><a href="native_apis.html">Native APIs</a>
</li>
<li><a href="payments_schematics_reference.html">Payments Schematics</a>
</li>
<li><a href="platform_support.html">Software requirements</a>
</li>
<li><a href="third_party_dependencies.html">Third-party dependencies</a>
</li>
<li><a href="troubleshoot_angular_10_upgrade.html">Troubleshooting Angular 10 upgrade</a>
</li>
</ul>
</li>
<li><a href="release_notes.html">Release notes</a>
<ul class="sectlevel2">
<li><a href="rb_3_10_1.html">Retail Banking Widget Collection v3.10.1</a>
</li>
<li><a href="rb_3100.html">Retail Banking Widget Collection v3.10.0</a>
</li>
<li><a href="rb_395.html">Retail Banking Widget Collection v3.9.5</a>
</li>
<li><a href="rb_394.html">Retail Banking Widget Collection v3.9.4</a>
</li>
<li><a href="rb_393.html">Retail Banking Widget Collection v3.9.3</a>
</li>
<li><a href="rb_392.html">Retail Banking Widget Collection v3.9.2</a>
</li>
<li><a href="rb_391.html">Retail Banking Widget Collection v3.9.1</a>
</li>
<li><a href="rb_390.html">Retail Banking Widget Collection v3.9.0</a>
<ul class="sectlevel3">
<li><a href="rb_390_web.html">Retail Banking Widget Collection v3.9.0 - Web</a>
</li>
<li><a href="rb_390_mob.html">Retail Banking Widget Collection v3.9.0 - Mobile</a>
</li>
</ul>
</li>
<li><a href="rb_381.html">Retail Banking Web Widget Collection v3.8.1</a>
</li>
<li><a href="rb_380.html">Retail Banking Web Widget Collection v3.8.0</a>
</li>
<li><a href="rb_371.html">Widget Collection Retail Banking v3.7.1</a>
<ul class="sectlevel3">
<li><a href="rb_371_web.html">Widget Collection Retail Banking v3.7.1 - Web</a>
</li>
<li><a href="rb_371_mob.html">Widget Collection Retail Banking v3.7.1 - Mobile</a>
</li>
</ul>
</li>
<li><a href="rb_370.html">Widget Collection Retail Banking v3.7.0</a>
</li>
<li><a href="rb_362.html">Widget Collection Retail Banking v3.6.2</a>
</li>
<li><a href="rb_361.html">Widget Collection Retail Banking v3.6.1</a>
</li>
<li><a href="rb_360.html">Widget Collection Retail Banking v3.6.0</a>
</li>
<li><a href="rb_353.html">Widget Collection Retail Banking v3.5.3</a>
</li>
<li><a href="rb_352.html">Widget Collection Retail Banking v3.5.2</a>
</li>
<li><a href="rb_351.html">Widget Collection Retail Banking v3.5.1</a>
</li>
<li><a href="rb_350.html">Widget Collection Retail Banking v3.5.0</a>
</li>
<li><a href="rb_343.html">Widget Collection Retail Banking v3.4.3</a>
</li>
<li><a href="rb_342.html">Widget Collection Retail Banking v3.4.2</a>
</li>
<li><a href="rb_341.html">Widget Collection Retail Banking v3.4.1</a>
</li>
<li><a href="rb_340.html">Widget Collection Retail Banking v3.4.0</a>
</li>
<li><a href="rb_330.html">Widget Collection Retail Banking v3.3.0</a>
</li>
<li><a href="rb_321.html">Retail Banking Widget Collection v3.2.1</a>
</li>
<li><a href="rb_320.html">Retail Banking Widget Collection v3.2.0</a>
</li>
<li><a href="rb_315.html">Retail Banking Widget Collection v3.1.5</a>
</li>
<li><a href="rb_314.html">Retail Banking Widget Collection v3.1.4</a>
</li>
<li><a href="rb_313.html">Retail Banking Widget Collection v3.1.3</a>
</li>
<li><a href="rbrn_312.html">Retail Banking Widget Collection v3.1.2</a>
</li>
<li><a href="rbrn_311.html">Retail Banking Widget Collection v3.1.1</a>
</li>
<li><a href="rbrn_310.html">Retail Banking Widget Collection v3.1.0</a>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<h1 id="implementing_an_oauth_20_compatible_auth_client" class="sect0">Implement an OAuth 2.0-compatible Auth Client</h1>
          <div class="paragraph">
<p>Although the Mobile SDK provides a default implementation for its
<a href="https://community.backbase.com/documentation/mobile-sdk/3.7.10/authentication">AuthClient feature</a>, in
many cases it is required to introduce an implementation to meet the
requirements of a given mobile banking project. This page provides a
practical example based on some aspects of the
<a href="https://oauth.net/2/">OAuth 2.0 protocol</a> explaining how the Auth
Client feature of the Mobile SDK can be applied to realise typical
mobile banking use cases. Specifically the concepts of an
<a href="https://tools.ietf.org/html/rfc6749#section-1.4">access token</a> and
<a href="https://tools.ietf.org/html/rfc6749#section-1.5">refresh token</a> will be used extensively.</p>
</div>
<div class="paragraph">
<p>IMPORTANT NOTE: OAuth 2.0 core specifications are most likely not
sufficient for meeting all requirements of your mobile banking project.
For example, the use of
<a href="https://tools.ietf.org/html/rfc7636">PKCE</a> and
<a href="https://tools.ietf.org/html/rfc7591">DCR</a> are
not described in this page. As a result, implementing an Auth Client
solely based on this document will not result in a PSD2-compliant mobile
banking app. While this page aims to be as comprehensive and practical
as possible, in order to keep things clear only core concepts of the
OAuth 2.0 specification are used to fulfil certain requirements. As a
result, essential implementation requirements might be missing. In all
cases, consider a security expert to review your architecture and/or
implementation. Use this page as an example but do not solely rely on
its content.</p>
</div>
<h2 id="_implementing_an_oauth_2_0_compatible_auth_client" class="discrete">Implementing an OAuth 2.0-compatible Auth Client</h2>
<div class="paragraph">
<p>A common pattern for mobile banking apps is to request the user to enrol
their device after starting the mobile app for the first time. The goal
of enrolment is to link the device to a specific user and
pre-authenticate it so the mobile app provides quicker access to its
functionality. Typically this includes the ability to identify a user
using strong credentials, for example based on a username and password
followed by a one-time password (OTP). After successful identification
the user is requested to setup a passcode, which is less strong but
allows quicker access when logging in after enrolment. During this step
the user can also be asked whether he/she wants to log in using
Fingerprint, TouchID or FaceID to allow even quicker access to the
mobile app. After enrolment, the user can quickly access the mobile
app&#8217;s functionality by providing a passcode, or by logging in using
<a href="https://developer.android.com/about/versions/marshmallow/android-6.0.html#fingerprint-authentication">Fingerprint</a>,
<a href="https://support.apple.com/en-us/HT201371">TouchID</a> or
<a href="https://support.apple.com/en-us/HT208108">FaceID</a>.
That functionality might also include the ability to make a payment
supporting step-up authentication (e.g. confirming a payment by
requesting to enter an OTP received by SMS) and the ability to disenroll
a device via another channel.</p>
</div>
<div class="paragraph">
<p>Summarising, the following user-facing authentication and
session-related features are required:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Checking whether a device is enrolled;</p>
</li>
<li>
<p>Identifying a user during enrolment;</p>
</li>
<li>
<p>Setting up a passcode;</p>
</li>
<li>
<p>Supporting Fingerprint, TouchID or FaceID;</p>
</li>
<li>
<p>Logging in using a passcode;</p>
</li>
<li>
<p>Step-up authentication;</p>
</li>
<li>
<p>Disenrolling a device.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Additional to these user facing features, typically some technical
features are also required. This example covers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Automatically renewing a session;</p>
</li>
<li>
<p>Handling a device disenrolled via another channel.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The next sections will provide suggestions how these features can be
implemented by assuming an authentication mechanism based on the
<a href="https://tools.ietf.org/html/rfc6749#section-1.4">access token</a> and
<a href="https://tools.ietf.org/html/rfc6749#section-1.5">refresh token</a> concepts part of OAuth 2.0.</p>
</div>
<div class="paragraph">
<p>Two concepts of the Backbase mobile product offering are used
extensively and we do highly recommend users to be fully aware of their
purpose and usage:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://community.backbase.com/documentation/mobile-sdk/3.7.10/authentication">AuthClient</a>: interfaces/protocols
and implementations responsible for authentication and session-related
features;</p>
</li>
<li>
<p><a href="https://community.backbase.com/documentation/mobile-sdk/3.7.10/error_response_resolver">Error Response Resolver</a>:
mechanism provided by the Mobile SDK that offers a
centralised way of handling failed responses before they reach their
callers.</p>
</li>
</ul>
</div>
<h3 id="_checking_whether_a_device_is_enrolled" class="discrete">Checking whether a device is enrolled</h3>
<div class="paragraph">
<p>During the start of the mobile app, it should check if the device is
already enrolled. If not, the enrolment flow should start. In order to
do this check, upon enrolment completion information needs to be stored
that can be used during this step to determine if the device is
enrolled. In its simplest form, enrolment means storing the refresh
token and passcode as can be read further on. As a result, this check
should check for the existence of a
<a href="https://tools.ietf.org/html/rfc6749#section-1.5">refresh token</a> and
passcode. Only when both are available the device is considered
enrolled.</p>
</div>
<div class="paragraph">
<p>The AuthClient interface/protocol, or any of its interfaces/protocols
provided by Backbase inheriting it, do not have a method definition
responsible for this check. However, it is recommended to introduce this
method in the MyCustomAuthClient implementation, which ultimately
extends the <code>AuthClient</code> interface/protocol, to keep all authentication
and session-related methods grouped together.</p>
</div>
<h3 id="_identifying_a_user_during_enrollment" class="discrete">Identifying a user during enrollment</h3>
<div class="paragraph">
<p>When a device is not considered enrolled, the user should be able to
enrol it. In order to do this, the user first needs to identify
him/herself. For this example we assume this is based on a username and
password, which means the Password widget
can be utilised. This widget is using
the <code>PasswordAuthClient</code> interface/protocol. Hence, the
custom <code>MyCustomAuthClient</code> implementation should implement
the <code>PasswordAuthClient</code> implementation/protocol requiring an
implementation of the method responsible for authentication based on a
user ID and related credentials. This method should at least perform a
network request to validate the provided username and password. Handle
the response by either showing an error (e.g. due an incorrect username
and/or password), asking the user to enter an OTP, or simply proceeding
to the next step enabling the user to setup a passcode.</p>
</div>
<div class="paragraph">
<p>As this example is covering the use of the refresh token concept, we
assume that a refresh token is part of the response in case
identification succeeded. This refresh token must be stored securely in
an encrypted manner, for example using the
<a href="https://community.backbase.com/documentation/mobile-sdk/3.7.10/encrypted_storage">encrypted storage feature</a>
provided by the Mobile SDK, and preferably should be bound to
the device exclusively. At this stage, the device is considered
pre-authenticated.</p>
</div>
<h3 id="_setting_up_a_passcode" class="discrete">Setting up a passcode</h3>
<div class="paragraph">
<p>Now the device is pre-authenticated (as a refresh token is obtained),
the user should setup a passcode enabling the user to quickly access the
mobile app&#8217;s functionality the next time the user tries to log in. The Passcode widget
is available for this purpose, which has two modes specifically
useful for setting up a passcode. Typically two instances of
the Passcode widget are used: one with mode (configurable as a
preference) set to setup and another one with mode set to confirm that
is shown directly after receiving confirmation from the widget that the
passcode was set successfully. The Passcode widget uses the
embedded <code>PasscodeAuthClient</code> interface/protocol to handle what happens
after providing a passcode. Refer to the widget&#8217;s documentation for more
information.</p>
</div>
<h3 id="_supporting_fingerprint_touchid_or_faceid" class="discrete">Supporting Fingerprint, TouchID or FaceID</h3>
<div class="paragraph">
<p>After successfully setting a passcode, in case the device supports it,
the mobile app should ask if the user wants to log in using
<a href="https://developer.android.com/about/versions/marshmallow/android-6.0.html#fingerprint-authentication">Fingerprint</a>,
<a href="https://support.apple.com/en-us/HT201371">TouchID</a> or
<a href="https://support.apple.com/en-us/HT208108">FaceID</a>.
These features are provided by the operating system and hence, work
(slightly) differently per platform. However, similar is the fact that
data used to identify a fingerprint or face is not stored within the
mobile app nor available to it. Instead, the mobile app requests the
operating system to request the user to identify him/herself using
either Fingerprint, TouchID or FaceID. The operating system is
responsible for comparing the data obtained from the scan with data
obtained earlier when a fingerprint or face was enrolled, outside of the
scope of the mobile app. One of the differences between Android and iOS
is the fact that on Android the dialog requesting the user to identify
him/herself using Fingerprint is constructed within the scope of the
mobile app while on iOS the dialog is shown by the operating system. On
both platforms, Fingerprint, TouchID or FaceID is not considered an
alternative to a passcode, pattern or password used to unlock a device
but is considered an addition. As a result, in order to
use Fingerprint, TouchID or FaceID a passcode, pattern or password has
to be setup as it also acts as a fallback.</p>
</div>
<div class="paragraph">
<p>As a result, during enrolment, the mobile app should request whether
authentication based on Fingerprint, TouchID or FaceID is preferred, but
only if:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The device supports Fingerprint, TouchID or FaceID, and;</p>
</li>
<li>
<p>At least one fingerprint or face is enrolled, and;</p>
</li>
<li>
<p>A passcode, pattern or password used to unlock a device is setup.
Typically this is already enforced by the previous requirement as no
fingerprint and/or face can be enrolled without this being the case.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When the user agrees, the mobile app should securely save this
preference in a permanent way, for example using the
<a href="https://community.backbase.com/documentation/mobile-sdk/3.7.10/encrypted-storage">encrypted storage feature</a>
provided by the Mobile SDK. It is recommended to store
this preference in a way that it only applies to the current
installation of the mobile app, for example by using a key that is only
known to the current installation of the mobile app.</p>
</div>
<div class="paragraph">
<p>After enrolment, when requesting the user to log in using a passcode
(described in the next section), the mobile app should offer the
possibility to have the user identify him/herself using Fingerprint,
TouchID or FaceID, but only if:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The above mentioned requirements are fulfilled, and;</p>
</li>
<li>
<p>The user agreed to log in using Fingerprint, TouchID or FaceID.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As stated before, the operating system is responsible for validating the
data of the fingerprint or face. It will provide the result of this
validation back to the mobile app. In case validation fails, the mobile
app should fallback to the passcode setup during enrolment. In case
validation succeeded, the mobile app should start a session. Since this
example covers (aspects of) OAuth 2.0, starting a session refers to
obtaining an access token using the refresh token stored securely during
the enrolment flow. This is also discussed in the next section.</p>
</div>
<h3 id="_logging_in_using_a_passcode" class="discrete">Logging in using a passcode</h3>
<div class="paragraph">
<p>Next to modes useful for enrolment purposes, the Passcode widget also can be used to authenticate a user. For this
mode authenticate should be used. When the user confirms a
passcode, <code>PasscodeAuthClient</code> 's <code>authenticate</code> implementation is
executed. Typically this implementation should validate the passcode
provided by comparing it with the passcode set during enrolment. When
the passcode is considered valid, a session should be started. Since
this example covers (aspects of) OAuth 2.0, starting a session refers to
obtaining an
<a href="https://tools.ietf.org/html/rfc6749#section-1.4">access token</a>
using the refresh token stored securely during the enrolment
flow. This access token is generally short-lived and can be stored
in-memory. The access token should be accessible
through AuthClient&#8217;s tokens implementation as it will be used by DBS
clients to apply session-related information as HTTP headers.</p>
</div>
<h3 id="_step_up_authentication" class="discrete">Step-up authentication</h3>
<div class="paragraph">
<p>Step-up authentication is often used in enrolment, authentication or
payment flows (potentially also to sign a payment). The reason might be
different for each project: a user is trying to log in from a country
he/she never has been, the amount of a payment is significantly higher
than usual, the device has been used for different accounts in the past
already, etc. Regardless of the reason, typically a step-up
authentication request is sent from the service by responding to a HTTP
request with status code 401 and a response header
named WWW-Authenticate with a value indicating the type of step-up
authentication requested as a challenge. It is the mobile app&#8217;s
responsibility to handle this response and request the user to perform a
step-up authentication. This might be presenting a view (e.g. an
instance of the Password widget in case the step-up authentication requested involves entering a
user ID and related credentials), asking a user to enter an OTP or
asking a user to authenticate using Fingerprint, TouchID or FaceID.
After providing authentication details, the original request (causing
the 401 response) should be repeated with an additional HTTP header
named for example Authorization or X-MFA with its value set to contain
the result of the step-up authentication attempt.</p>
</div>
<div class="paragraph">
<p>The Mobile SDK&#8217;s
<a href="https://community.backbase.com/documentation/mobile-sdk/3.7.10/error_response_resolver">Error Response Resolver</a>
is particularly useful for handling step-up authentication
requests. It allows a developer to register a handler for specific HTTP
error codes identified as failed requests, including 401. Since this
handler is applied on mobile app level, it applies to all widgets,
clients and other components performing network requests, except from
web widgets rendered using the Mobile SDK on Android due a limitation of the
<a href="https://community.backbase.com/documentation/mobile-sdk/3.7.10/network_connector_library">Network Connector</a>.
After resolving the challenge, the resulting should be
appended to the original request as a header. Next, the request should
be executed again.</p>
</div>
<h3 id="_disenrolling_a_device" class="discrete">Disenrolling a device</h3>
<div class="paragraph">
<p>In this example a device is considered enrolled when a refresh token is
stored. Hence, in order to disenroll a device, the refresh token should
be deleted and the user should be returned to the enrolment flow.
Additional user and/or session-related information stored locally such
as the access token should be cleared too. Typically the server should
also be notified of a user disenrolling. By doing this, the list with
clients (e.g. devices) having access to the user&#8217;s data can be updated.</p>
</div>
<h3 id="_automatically_renewing_a_session" class="discrete">Automatically renewing a session</h3>
<div class="paragraph">
<p>An access token typically has a short lifetime whereas a refresh
token has a long lifetime, sometimes even indefinite lifetime. In most
cases a 401 Unauthorized response is returned when an invalid token is
used. As a result, the Mobile SDK&#8217;s Error Response Resolver can be used
to attach a handler to this type of response. As there can be multiple
reasons why a 401 Unauthorized response is received, it is probably
needed to inspect the response body for an indication that the error was
caused by an invalid/expired access token. For example, this could be a
key called <code>error_type</code> with value <code>invalid_access_token</code>.</p>
</div>
<div class="paragraph">
<p>Upon confirming that the 401 Unauthorized response is received due an
invalid/expired access token, the Mobile SDK&#8217;s
<a href="https://community.backbase.com/documentation/mobile-sdk/3.7.10/error_response_resolver">Error Response Resolver</a>
can try to renew the access token using the refresh
token by performing a network request, similar to the requests used in
the example in the Logging in using a passcode section of this document.
Hence, preferably it should use the same API. When the refresh token is
considered invalid another 401 Unauthorized response is typically
received with a response body indicating this. For example by having
key <code>error_type</code> set to <code>invalid_refresh_token</code>. This is likely caused
by the device being disenrolled via another channel, which is described
in the next section. In most cases refreshing the access token using
the refresh token simply succeeds. The renewed access token should be
stored and the original request (that caused the 401
Unauthorized response) should be executed again with the renewed access
token using the
<a href="https://community.backbase.com/documentation/mobile-sdk/3.7.10/error_response_resolver">Mobile SDK&#8217;s Error Response Resolver</a>. As a result of this (automatic)
mechanism, a user should typically not experience anything of this.</p>
</div>
<h3 id="_handling_a_device_disenrolled_via_another_channel" class="discrete">Handling a device disenrolled via another channel</h3>
<div class="paragraph">
<p>A device can be disenrolled via another channel. This could be the user
indicating the device is lost (e.g. via a web page), a customer service
employee on behalf of the user or even automatically by the system in
case fraudulent activities are detected. In any case, the refresh
token for that given device should be revoked meaning that a
(short-lived) access token cannot be obtained using the (locally-stored
and long-lived) refresh token. As a result, a 401 Unauthorized response
is returned upon (automatically) renewing a session and/or when logging
in. The response body should indicate that the error is triggered
because of an invalid refresh token, as it has been revoked. This allows
the mobile app to respond by return the user to the enrolment flow
providing an additional message indicating that the user should enrol
again due security reasons.</p>
</div>
<div class="paragraph">
<p>In this example the access token is not invalidated meaning invalidated
devices can still perform authenticated network requests until the
(short-lived) access token expires. In most cases this is not acceptable
and hence, the authorization server should supports the (automatic)
revocation of access tokens too. Refer to
<a href="https://tools.ietf.org/html/rfc7009">RFC 7009 (OAuth 2.0 Token Revocation</a>
for more information about revoking tokens.</p>
</div>
</div>
</body>
</html>